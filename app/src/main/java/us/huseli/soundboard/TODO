Tryck p√• ljud:
play()
    Om state == READY:
        doPlay()
            state = INIT_PLAY
            Skapa audioTrack
            Spela
            state = PLAYING
Vid stopp:
    doStop()
        audioTrack.pause()
        state = STOPPED
        audioTrack.release()
        audioTrack = null
prepare():
    state = INITIALIZING
    init/flush codec
    extractor seekTo 0


2021-03-05 01:52:23.413 513-15978 E/AF::Track: Track(554): no more tracks available
2021-03-05 01:52:23.431 513-15978 E/AF::Track: Track(555): no more tracks available
2021-03-05 01:52:23.450 513-15978 E/AF::Track: Track(556): no more tracks available
2021-03-05 01:52:23.464 513-15978 E/AF::Track: Track(557): no more tracks available

!!!! https://stackoverflow.com/questions/8388053/soundpool-error-no-more-track-names-available !!!!
"For audio, there's a hard limit of 32 active AudioTrack objects per device (not per app: you need
to share those 32 with rest of the system)"
FFFFFUUUUUUU.
So I guess AudioTrack has to be re-inited on each play and then released on stop.




Try to avoid running flushCodec and extractor.seekTo() on prepare() if not necessary (takes ~3 ms)


After non-working fucking sound has been "played", duration view disappears


Can I get sound "range select" to work over category boundaries?


Category.order does not seem to get set on category createion!


Somehow detect how long time has gone between clicking on a sound card and sound actually beginning
playing, and bail if some timeout has reached (could happen during heavy load).


Maybe save repress mode and reinit on activity restart? (Not necessarily on application restart;
I just want to preserve it when switching between activities)


Steps to speed up time from click to sound starting playing:
* Intercept the touch event as soon as possible (i.e. in the activity), send straight to play
method without middlemen
* Play on touch event in SoundViewHolder, instead of click event


Layout takes lots of time (well, mostly while debugging, not so much on regular runs).
Mostly RecyclerView.onMeasure() and ConstraintLayout.onMeasure() (for
individual sounds). How to optimize? Something with autoMeasure perhaps?
https://developer.android.com/reference/kotlin/androidx/recyclerview/widget/RecyclerView.LayoutManager#isautomeasureenabled


"Stress test" with lots of sounds; is it true that there's a limit of 128 AudioTrack objects?
In that case, release those objects that are farthest from being visible


Fix repress mode stuff (what??)


On "instant replay" stop mode, make sure everything is completely initialized before running play() again


Q: Some sounds (especially short ones) don't play? writeAudioTrack() gets called once but then nothing.
A: "If you don't call write() first, or if you call write() but with an insufficient amount of data,
then the track will be in underrun state at play(). In this case, playback will not actually start
playing until the data path is filled to a device-specific minimum level."
-- https://developer.android.com/reference/kotlin/android/media/AudioTrack#play

Maybe need to send it at least BUFFER_SIZE bytes? Trying padding last buffer with zeros.
Padding seems to work! \o/


AudioFile:
We need to somehow:
1. Know when the audio priming is ready (all priming data has been read from codec AND fed into audioTrack)
2. Then, and at no time before, run codec.flush()

On user initiated stop: do forceStop() which cuts playback and cancels codec etc
After playback has run its length and has not been stopped by user:
1. Somehow check if CodecCallback is still doing decoding/playback queuing
2. When it's not: do the stop stuff


Look at backup_descriptor.xml stuff


When collapsing last category, its header disappears from view until you scroll, then reappears
CategoryAdapter.onViewDetachedFromWindow() is run for that holder and it's hidden. Why?


On ordering enabled: scroll with 2 fingers?


Clean up Log calls


After altering a category, play icon & volumebar on sounds dont work? (Cannot recreate?)


In some instance, when creating categories and moving sounds around, an empty category was
populated with another category's sounds (How to recreate?)


Check for usages of adapterPosition/layoutPosition and correct according to
https://developer.android.com/reference/kotlin/androidx/recyclerview/widget/RecyclerView#positions-in-recyclerview:


Make sure old adapters & viewholders are garbage collected on config change/rotate, they don't seem
to be doing so automatically


Write tests :-//////////////


Trash CategoryListFragment, put it all in MainActivity?
